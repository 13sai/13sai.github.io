

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/qiniu/sai.ico">
  <link rel="icon" href="/images/qiniu/sai.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#1E90FF">
  <meta name="author" content="13sai">
  <meta name="keywords" content="13sai,golang,Redis,Redis,Linux,MQ">
  
    <meta name="description" content="小白必须懂的MongoDB的十大总结">
<meta property="og:type" content="article">
<meta property="og:title" content="小白必须懂的MongoDB的十大总结">
<meta property="og:url" content="https://github.13sai.com/2021/02/03/307/index.html">
<meta property="og:site_name" content="13sai blog">
<meta property="og:description" content="小白必须懂的MongoDB的十大总结">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114306285-1771114626.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114306050-1415358397.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305680-1029309229.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305409-450104353.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305192-1179456160.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114304941-156604371.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114303961-459207762.png">
<meta property="article:published_time" content="2021-02-03T04:11:33.000Z">
<meta property="article:modified_time" content="2022-03-19T14:35:21.909Z">
<meta property="article:author" content="13sai">
<meta property="article:tag" content="MongoDB">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114306285-1771114626.png">
  
  
  <title>小白必须懂的MongoDB的十大总结 - 13sai blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"github.13sai.com","root":"/","version":"1.8.14","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"21791f27481aa4e0d1d544dde68bdb36","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>13sai blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                专栏
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/goexample/">
                    
                    实例学go
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/gosourcecode/">
                    
                    go源码笔记
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/phpframe/">
                    
                    手写PHP API框架
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reading/">
                    
                    读书笔记
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Nginx/">
                    
                    Nginx系列
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/MySQL/">
                    
                    Mysql系列
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/Redis/">
                    
                    Redis系列
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookmark/">
                <i class="iconfont icon-bookmark"></i>
                书签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">小白必须懂的MongoDB的十大总结</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-02-03 12:11" pubdate>
          2021年2月3日
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          26k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          217 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="db"
        id="heading-d77d5e503ad1439f585ac494268b351b" role="tab" data-toggle="collapse" href="#collapse-d77d5e503ad1439f585ac494268b351b"
        aria-expanded="true"
      >
        db
        <span class="list-group-count">(16)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-d77d5e503ad1439f585ac494268b351b"
           role="tabpanel" aria-labelledby="heading-d77d5e503ad1439f585ac494268b351b">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2021/08/08/361/" title="boltdb的使用"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">boltdb的使用</span>
        </a>
      
    
      
      
        <a href="/2021/02/03/307/" title="小白必须懂的MongoDB的十大总结"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">小白必须懂的MongoDB的十大总结</span>
        </a>
      
    
      
      
        <a href="/2020/12/24/301/" title="MongoDB的简单使用说明"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">MongoDB的简单使用说明</span>
        </a>
      
    
      
      
        <a href="/2019/09/08/198/" title="通过mysqlbinlog恢复误操作清空的表"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">通过mysqlbinlog恢复误操作清空的表</span>
        </a>
      
    
      
      
        <a href="/2019/09/04/197/" title="mysql分页重复"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">mysql分页重复</span>
        </a>
      
    
      
      
        <a href="/2019/01/12/177/" title="基于mycat实现读写分离"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">基于mycat实现读写分离</span>
        </a>
      
    
      
      
        <a href="/2019/01/11/176/" title="如何恢复误删的数据库"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">如何恢复误删的数据库</span>
        </a>
      
    
      
      
        <a href="/2018/12/30/175/" title="mysql高可用探讨（读写分离）"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">mysql高可用探讨（读写分离）</span>
        </a>
      
    
      
      
        <a href="/2018/08/31/168/" title="小型商城商品模块设计"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">小型商城商品模块设计</span>
        </a>
      
    
      
      
        <a href="/2018/05/31/157/" title="关于大表查询最后几页过慢的原因"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">关于大表查询最后几页过慢的原因</span>
        </a>
      
    
      
      
        <a href="/2018/04/18/152/" title="mysql触发器"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">mysql触发器</span>
        </a>
      
    
      
      
        <a href="/2018/03/19/150/" title="常见mysql"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">常见mysql</span>
        </a>
      
    
      
      
        <a href="/2017/05/02/120/" title="数据库设计的范式与反范式"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">数据库设计的范式与反范式</span>
        </a>
      
    
      
      
        <a href="/2016/08/10/64/" title="MySQL数据类型和常用字段属性"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">MySQL数据类型和常用字段属性</span>
        </a>
      
    
      
      
        <a href="/2016/02/01/17/" title="数据库设计范式"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">数据库设计范式</span>
        </a>
      
    
      
      
        <a href="/2015/12/01/3/" title="关于mysql数据库可查询不可写入的问题"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">关于mysql数据库可查询不可写入的问题</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">小白必须懂的MongoDB的十大总结</h1>
            
            <div class="markdown-body">
              
              <blockquote>
<p>文章来源: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ECJTUACM-873284962/p/9613236.html">小白必须懂的MongoDB的十大总结</a></p>
</blockquote>
<h3 id="一、MongoDB的认识"><a href="#一、MongoDB的认识" class="headerlink" title="一、MongoDB的认识"></a>一、MongoDB的认识</h3><h4 id="1、什么是MongoDB？"><a href="#1、什么是MongoDB？" class="headerlink" title="1、什么是MongoDB？"></a>1、什么是MongoDB？</h4><p><code>MongoDB</code> 是一个介于关系数据库和非关系数据库之间的开源产品，是最接近于关系型数据库的 <code>NoSQL</code> 数据库。它在轻量级<code>JSON</code> 交换基础之上进行了扩展，即称为 <code>BSON</code> 的方式来描述其无结构化的数据类型。尽管如此它同样可以存储较为复杂的数据类型。它和Redis有异曲同工之妙。虽然两者均为 <code>NoSQL</code> ，但是 <code>MongoDB</code> 相对于 <code>Redis</code> 而言，<code>MongoDB</code> 更像是传统的数据库。早些年我们是先有了 <code>Relation Database</code> (关系型数据库)，然后出现了很多很复杂的<code>query</code> ，里面用到了很多嵌套，很多 <code>join</code> 操作。所以在设计数据库的时候，我们也考虑到了如何应用他们的关系，使得写 <code>query</code> 可以使 <code>database</code> 效率达到最高。后来人们发现，不是每个系统，都需要如此复杂的关系型数据库。有些简单的网站，比如博客，比如社交网站，完全可以斩断数据库之间的一切关系。这样做带来的好处是，设计数据库变得更加简单，写 <code>query</code> 也变得更加简单。然后，<code>query</code> 消耗的时间可能也会变少。因为 <code>query</code> 简单了，少了许多消耗资源的 <code>join</code> 操作，速度自然会上去。正如所说的， <code>query</code> 简单了，很有以前 <code>MySQL</code> 可以找到的东西，现在关系没了，通过 <code>Mongo</code> 找不到了。我们只能将几组数据都抓到本地，然后在本地做 <code>join</code> ，所以在这点上可能会消耗很多资源。这里我们可以发现。如何选择数据库，完全取决于你所需要处理的数据的模型，即 <code>Data Model</code> 。如果它们之间，关系错综复杂，千丝万缕，这个时候 <code>MySQL</code> 一定是首选。如果他们的关系并不是那么密切，那么， <code>NoSQL</code> 将会是利器。</p>
<p><code>MongoDB</code> 和 <code>Redis</code> 一样均为 <code>key-value</code> 存储系统，它具有以下特点：</p>
<ul>
<li>面向集合存储，易存储对象类型的数据。</li>
<li>模式自由。</li>
<li>支持动态查询。</li>
<li>支持完全索引，包含内部对象。</li>
<li>支持查询。</li>
<li>支持复制和故障恢复。</li>
<li>使用高效的二进制数据存储，包括大型对象(如视频等)。</li>
<li>自动处理碎片，以支持云计算层次的扩展性</li>
<li>支持 <code>Python</code> ， <code>PHP</code> ， <code>Ruby</code> ， <code>Java</code> ， <code>C</code> ， <code>C#</code> ， <code>Javascript</code> ，<code>Perl</code> 及 <code>C++</code> 语言的驱动程序，社区中也提供了对 <code>Erlang</code> 及 <code>.NET</code> 等平台的驱动程序。</li>
<li>文件存储格式为 <code>BSON</code> (一种 <code>JSON</code> 的扩展)。</li>
<li>可通过网络访问。</li>
</ul>
<h4 id="2、MongoDB与MySQL性能比较"><a href="#2、MongoDB与MySQL性能比较" class="headerlink" title="2、MongoDB与MySQL性能比较"></a>2、MongoDB与MySQL性能比较</h4><p>像 <code>MySQL</code> 一样， <code>MongoDB</code> 提供了丰富的远远超出了简单的键值存储中提供的功能和功能。 <code>MongoDB</code> 具有查询语言，功能强大的辅助索引(包括文本搜索和地理空间)，数据分析功能强大的聚合框架等。相比使用关系数据库而言，使用<code>MongoDB</code> ，您还可以使用如下表所示的这些功能，跨越更多样化的数据类型和数据规模。</p>
<table>
<thead>
<tr>
<th></th>
<th><code>MySQL</code></th>
<th><code>MongoDB</code></th>
</tr>
</thead>
<tbody><tr>
<td>丰富的数据模型</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>动态 <code>Schema</code></td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>数据类型</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>数据本地化</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>字段更新</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>易于编程</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>复杂事务</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>审计</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>自动分片</td>
<td>否</td>
<td>是</td>
</tr>
</tbody></table>
<p><code>MySQL</code> 中的许多概念在 <code>MongoDB</code> 中具有相近的类比。本表概述了每个系统中的一些常见概念。</p>
<table>
<thead>
<tr>
<th><code>MySQL</code></th>
<th><code>MongoDB</code></th>
</tr>
</thead>
<tbody><tr>
<td>表</td>
<td>集合</td>
</tr>
<tr>
<td>行</td>
<td>文档</td>
</tr>
<tr>
<td>列</td>
<td>字段</td>
</tr>
<tr>
<td><code>joins</code></td>
<td>嵌入文档或者链接</td>
</tr>
</tbody></table>
<h4 id="3、应用范围和限制"><a href="#3、应用范围和限制" class="headerlink" title="3、应用范围和限制"></a>3、应用范围和限制</h4><p><code>MongoDB</code> 的主要目标是在 <code>key-value</code> (键/值)存储方式(提供了高性能和高度伸缩性)以及传统的 <code>RDBMS</code> 系统(丰富的功能)架起一座桥梁，集两者的优势于一身。 <code>MongoDB</code> 适用范围如下：</p>
<ul>
<li><strong>网站数据：</strong> <code>Mongo</code> 非常适合实时的插入，更新与查询，并具备网站实时数据存储所需的复制及高度伸缩性。</li>
<li><strong>缓存：</strong>由于性能很高， <code>Mongo</code> 也适合作为信息基础设施的缓存层。在系统重启之后，由 <code>Mongo</code> 搭建的持久化缓存层可以避免下层的数据源过载。</li>
<li><strong>大尺寸，低价值的数据：</strong>使用传统的关系型数据库存储一些数据时可能会比较昂贵，在此之前，很多时候程序员往往会选择传统的文件进行存储。</li>
<li><strong>高伸缩性的场景：</strong> <code>Mongo</code> 非常适合由数十或数百台服务器组成的数据库。 <code>Mongo</code> 的路线图中已经包含对 <code>MapReduce</code> 引擎的内置支持。</li>
<li><strong>用于对象及 JSON 数据的存储：</strong> <code>Mongo</code> 的 <code>BSON</code> 数据格式非常适合文档化格式的存储及查询。</li>
</ul>
<p><code>MongoDB</code> 当然也会有以下场景的限制：</p>
<ul>
<li>高度事物性的系统：例如银行或会计系统。传统的关系型数据库目前还是更适用于需要大量原子性复杂事务的应用程序。</li>
<li>传统的商业智能应用：针对特定问题的 <code>BI</code> 数据库会对产生高度优化的查询方式。对于此类应用，数据仓库可能是更合适的选择。</li>
<li>需要 <code>SQL</code> 的问题。</li>
</ul>
<h3 id="二、MongoDB的安装"><a href="#二、MongoDB的安装" class="headerlink" title="二、MongoDB的安装"></a>二、MongoDB的安装</h3><h4 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a><strong>环境准备</strong></h4><ul>
<li>CentOS7</li>
<li><a target="_blank" rel="noopener" href="https://repo.mongodb.org/yum/amazon/2013.03/mongodb-org/3.6/x86_64/">MongoDB 3.6</a></li>
</ul>
<h4 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a><strong>安装步骤</strong></h4><h5 id="1、创建一个-mongodb-org-3-6-repo-文件"><a href="#1、创建一个-mongodb-org-3-6-repo-文件" class="headerlink" title="1、创建一个 mongodb-org-3.6.repo 文件"></a>1、创建一个 <code>mongodb-org-3.6.repo</code> 文件</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">vi</span> /etc/yum.repos.d/mongodb-org-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.repo<br></code></pre></td></tr></table></figure>

<p>在文件中加入如下内容：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">[mongodb-org-<span class="hljs-number">3.6</span>]<br>name=MongoDB Repository<br>baseurl=https:<span class="hljs-regexp">//</span>repo.mongodb.org<span class="hljs-regexp">/yum/</span>amazon<span class="hljs-regexp">/2013.03/m</span>ongodb-org<span class="hljs-regexp">/3.6/</span>x86_64/<br>gpgcheck=<span class="hljs-number">1</span><br>enabled=<span class="hljs-number">1</span><br>gpgkey=https:<span class="hljs-regexp">//</span>www.mongodb.org<span class="hljs-regexp">/static/</span>pgp/server-<span class="hljs-number">3.6</span>.asc<br></code></pre></td></tr></table></figure>

<p>退出编辑模式，直接输入如下命令安装即可：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo yum <span class="hljs-keyword">install</span> -y mongodb-org<br></code></pre></td></tr></table></figure>

<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114306285-1771114626.png" srcset="/img/loading.gif" lazyload alt="MongoDB"></p>
<p>若要安装特定版本的 <code>MongoDB</code> ，请分别指定每个组件包并将版本号附加到包名称，如下所示：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> yum install -y mongodb-org-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span> mongodb-org-server-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span> mongodb-org-shell-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span> mongodb-org-mongos-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span> mongodb-org-tools-<span class="hljs-number">3</span>.<span class="hljs-number">6</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<p>你可以指定任何可用的 <code>MongoDB</code> 版本。然而， <code>yum</code> 会在新版本可用时升级软件包。为防止意外升级，请钉住包装。要固定软件包，请将以下 <code>exclude</code> 指令添加到 <code>/etc/yum.conf</code> 文件中：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">exclude</span>=mongodb-org,mongodb-org-server,mongodb-org-shell,mongodb-org-mongos,mongodb-org-tools<br></code></pre></td></tr></table></figure>

<p>我们直接运行如下命令：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">mongod -repair</span><br></code></pre></td></tr></table></figure>

<p>看到如下字样，说明我们安装成功！</p>
<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114306050-1415358397.png" srcset="/img/loading.gif" lazyload alt="MongoDB_3"></p>
<p>我们创建一个 <code>db</code> ，并查看下 <code>mongo</code> 的安装位置：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">mkdir</span> <span class="hljs-keyword">db</span><br>whereis mongod<br></code></pre></td></tr></table></figure>

<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305680-1029309229.png" srcset="/img/loading.gif" lazyload alt="MongoDB_2"></p>
<p>安装完成后启动 <code>mongodb</code> ，并查看下 <code>mongob</code> 启动状态：</p>
<figure class="highlight thrift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs thrift">systemctl start mongod.<span class="hljs-keyword">service</span><br>systemctl status mongod.<span class="hljs-keyword">service</span><br></code></pre></td></tr></table></figure>

<p>如果出现如下字样，说明启动成功！</p>
<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305409-450104353.png" srcset="/img/loading.gif" lazyload alt="MongoDB_4"></p>
<p>成功启动 <code>MongoDB</code> 后，新建一个命令行输入 <code>mongo</code> 进行登录操作，即可进行数据库的一些操作了。</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">mongo</span><br></code></pre></td></tr></table></figure>

<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114305192-1179456160.png" srcset="/img/loading.gif" lazyload alt="MongoDB_5"></p>
<h3 id="三、MongoDB数据类型及常用命令讲解"><a href="#三、MongoDB数据类型及常用命令讲解" class="headerlink" title="三、MongoDB数据类型及常用命令讲解"></a>三、MongoDB数据类型及常用命令讲解</h3><p><code>MongoDB</code> 的数据类型大致有下列几种：</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>String</code></td>
<td>字符串。存储数据常用的数据类型。在 <code>MongoDB</code> 中，<code>UTF-8</code> 编码的字符串才是合法的。</td>
</tr>
<tr>
<td><code>Integer</code></td>
<td>整型数值。用于存储数值。根据你所采用的服务器，可分为 <code>32</code> 位或 <code>64</code> 位。</td>
</tr>
<tr>
<td><code>Boolean</code></td>
<td>布尔值。用于存储布尔值（真/假）。</td>
</tr>
<tr>
<td><code>Double</code></td>
<td>双精度浮点值。用于存储浮点值。</td>
</tr>
<tr>
<td><code>Min/Max keys</code></td>
<td>将一个值与 <code>BSON</code> (二进制的 <code>JSON</code>)元素的最低值和最高值相对比。</td>
</tr>
<tr>
<td><code>Arrays</code></td>
<td>用于将数组或列表或多个值存储为一个键。</td>
</tr>
<tr>
<td><code>Timestamp</code></td>
<td>时间戳。记录文档修改或添加的具体时间。</td>
</tr>
<tr>
<td><code>Object</code></td>
<td>用于内嵌文档。</td>
</tr>
<tr>
<td><code>Null</code></td>
<td>用于创建空值。</td>
</tr>
<tr>
<td><code>Symbol</code></td>
<td>符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。</td>
</tr>
<tr>
<td><code>Date</code></td>
<td>日期时间。用 <code>UNIX</code> 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 <code>Date</code> 对象，传入年月日信息。</td>
</tr>
<tr>
<td><code>Object ID</code></td>
<td>对象 <code>ID</code>。用于创建文档的 <code>ID</code>。</td>
</tr>
<tr>
<td><code>Binary Data</code></td>
<td>二进制数据。用于存储二进制数据。</td>
</tr>
<tr>
<td><code>Code</code></td>
<td>代码类型。用于在文档中存储 <code>JavaScript</code> 代码。</td>
</tr>
<tr>
<td><code>Regular expression</code></td>
<td>正则表达式类型。用于存储正则表达式。</td>
</tr>
</tbody></table>
<p>下面我们将介绍一些 <code>MongoDB</code> 的常用命令！</p>
<h5 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h5><p><code>use 数据库名称</code> ：创建一个新的数据库。注意：如果该数据库不存在，则创建，如果该数据库存在，则是切换<br>如果创建了数据库，没有任何的操作，则会自动删除该数据库</p>
<p>example：</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">&gt; <span class="hljs-keyword">use</span> stu<br>switched <span class="hljs-keyword">to</span> db stu<br></code></pre></td></tr></table></figure>

<h5 id="2、查看数据库"><a href="#2、查看数据库" class="headerlink" title="2、查看数据库"></a>2、查看数据库</h5><p><code>show dbs</code> ：查看当前有多少个数据库</p>
<p>example：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&gt; <span class="hljs-keyword">show</span> dbs<br><span class="hljs-keyword">admin</span>   <span class="hljs-number">0.000</span>GB<br>config  <span class="hljs-number">0.000</span>GB<br><span class="hljs-keyword">local</span>   <span class="hljs-number">0.000</span>GB<br></code></pre></td></tr></table></figure>

<h5 id="3、创建集合"><a href="#3、创建集合" class="headerlink" title="3、创建集合"></a>3、创建集合</h5><p><code>db.集合名.insert(&#123;&#125;)</code> ：向集合里面，添加文档。<code>&#123;&#125;</code> 里面是 <code>json</code> 的文档。注意： <code>mongodb</code> 里面的集合是隐式创建，就是无需创建，直接使用。 <code>db</code> 表示显示当前所在的数据库。</p>
<p>example：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.insert</span>(&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;xiaoming&quot;</span>,<span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">20</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;xiaoming@gmail.com&quot;</span>&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nInserted&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.insert</span>(&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;xiaohong&quot;</span>,<span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">18</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;xiaohong@gmail.com&quot;</span>&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nInserted&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br></code></pre></td></tr></table></figure>

<h5 id="4、查看集合"><a href="#4、查看集合" class="headerlink" title="4、查看集合"></a>4、查看集合</h5><p><code>show tables</code> ：查看当前数据库中的集合</p>
<p>example：</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">show tables</span><br>php<br></code></pre></td></tr></table></figure>

<h5 id="5、查询集合里面的文档"><a href="#5、查询集合里面的文档" class="headerlink" title="5、查询集合里面的文档"></a>5、查询集合里面的文档</h5><p><code>db.集合名.find()</code> ：查询当前数据库中该集合下的所有文档</p>
<p>example：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b9318ac487b851e62879578&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoming&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">20</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaoming@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b9319a2487b851e62879579&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaohong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">18</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaohong@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p><code>db.集合名.find</code> ：查询当前数据库中该集合下的第一个文档</p>
<p>example：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">&gt; db.php.find<br>function (query, fields, limit, skip, batchSize, options) &#123;<br>    <span class="hljs-keyword">var</span> cursor = new DBQuery(<span class="hljs-keyword">this</span>._mongo,<br>                             <span class="hljs-keyword">this</span>._db,<br>                             <span class="hljs-keyword">this</span>,<br>                             <span class="hljs-keyword">this</span>._fullName,<br>                             <span class="hljs-keyword">this</span>._massageObject(query),<br>                             fields,<br>                             limit,<br>                             skip,<br>                             batchSize,<br>                             options || <span class="hljs-keyword">this</span>.getQueryOptions());<br><br>    &#123;<br>        <span class="hljs-keyword">const</span> session = <span class="hljs-keyword">this</span>.getDB().getSession();<br><br>        <span class="hljs-keyword">const</span> readPreference = session._serverSession.client.getReadPreference(session);<br>        <span class="hljs-keyword">if</span> (readPreference !== <span class="hljs-literal">null</span>) &#123;<br>            cursor.readPref(readPreference.mode, readPreference.tags);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> readConcern = session._serverSession.client.getReadConcern(session);<br>        <span class="hljs-keyword">if</span> (readConcern !== <span class="hljs-literal">null</span>) &#123;<br>            cursor.readConcern(readConcern.level);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> cursor;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="6、删除集合"><a href="#6、删除集合" class="headerlink" title="6、删除集合"></a>6、删除集合</h5><p><code>db.集合名.drop()</code> ：删除当前数据库中的集合</p>
<p>example：</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">db.php.drop()</span><br>true<br></code></pre></td></tr></table></figure>

<h5 id="7、删除数据库"><a href="#7、删除数据库" class="headerlink" title="7、删除数据库"></a>7、删除数据库</h5><p><code>db.dropDatabase()</code> ：删除当前的数据库</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&gt; db.dropDatabase<span class="hljs-comment">()</span><br>&#123; <span class="hljs-string">&quot;dropped&quot;</span> : <span class="hljs-string">&quot;stu&quot;</span>, <span class="hljs-string">&quot;ok&quot;</span> : <span class="hljs-number">1</span> &#125;<br></code></pre></td></tr></table></figure>

<h5 id="8、帮助命令"><a href="#8、帮助命令" class="headerlink" title="8、帮助命令"></a>8、帮助命令</h5><p><code>help</code> ：全局帮助命令</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&gt; help<br>    db.help()                    help <span class="hljs-keyword">on</span> db methods<br>    db.mycoll.help()             help <span class="hljs-keyword">on</span> collection methods<br>    sh.help()                    sharding helpers<br>    rs.help()                    <span class="hljs-keyword">replica</span> <span class="hljs-keyword">set</span> helpers<br>    help <span class="hljs-keyword">admin</span>                   administrative help<br>    help <span class="hljs-keyword">connect</span>                 connecting <span class="hljs-keyword">to</span> a db help<br>    help keys                    key shortcuts<br>    help misc                    misc things <span class="hljs-keyword">to</span> know<br>    help mr                      mapreduce<br><br>    <span class="hljs-keyword">show</span> dbs                     <span class="hljs-keyword">show</span> <span class="hljs-keyword">database</span> names<br>    <span class="hljs-keyword">show</span> collections             <span class="hljs-keyword">show</span> collections <span class="hljs-keyword">in</span> <span class="hljs-keyword">current</span> <span class="hljs-keyword">database</span><br>    <span class="hljs-keyword">show</span> users                   <span class="hljs-keyword">show</span> users <span class="hljs-keyword">in</span> <span class="hljs-keyword">current</span> <span class="hljs-keyword">database</span><br>    <span class="hljs-keyword">show</span> profile                 <span class="hljs-keyword">show</span> most recent <span class="hljs-keyword">system</span>.profile entries <span class="hljs-keyword">with</span> <span class="hljs-type">time</span> &gt;= <span class="hljs-number">1</span>ms<br>    <span class="hljs-keyword">show</span> logs                    <span class="hljs-keyword">show</span> the accessible logger names<br>    <span class="hljs-keyword">show</span> <span class="hljs-keyword">log</span> [<span class="hljs-type">name</span>]              prints <span class="hljs-keyword">out</span> the last segment <span class="hljs-keyword">of</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">in</span> memory, <span class="hljs-string">&#x27;global&#x27;</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">default</span><br>    use                 <span class="hljs-keyword">set</span> <span class="hljs-keyword">current</span> <span class="hljs-keyword">database</span><br>    db.foo.find()                list objects <span class="hljs-keyword">in</span> collection foo<br>    db.foo.find( &#123; a : <span class="hljs-number">1</span> &#125; )     list objects <span class="hljs-keyword">in</span> foo <span class="hljs-keyword">where</span> a == <span class="hljs-number">1</span><br>    it                           result <span class="hljs-keyword">of</span> the last <span class="hljs-type">line</span> evaluated; use <span class="hljs-keyword">to</span> further iterate<br>    DBQuery.shellBatchSize = x   <span class="hljs-keyword">set</span> <span class="hljs-keyword">default</span> number <span class="hljs-keyword">of</span> items <span class="hljs-keyword">to</span> display <span class="hljs-keyword">on</span> shell<br>    <span class="hljs-keyword">exit</span>                         quit the mongo shell<br></code></pre></td></tr></table></figure>

<p><code>db.help()</code> ：数据库相关的帮助命令</p>
<p>example：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs stata">&gt; <span class="hljs-keyword">db</span>.<span class="hljs-keyword">help</span>()<br><span class="hljs-keyword">DB</span> methods:<br>    <span class="hljs-keyword">db</span>.adminCommand(nameOrDocument) - switches to &#x27;admin&#x27; <span class="hljs-keyword">db</span>, and runs command [just calls <span class="hljs-keyword">db</span>.runCommand(...)]<br>    <span class="hljs-keyword">db</span>.aggregate([pipeline], &#123;options&#125;) - performs a collectionless aggregation <span class="hljs-keyword">on</span> this database; returns a cursor<br>    <span class="hljs-keyword">db</span>.auth(username, password)<br>    <span class="hljs-keyword">db</span>.cloneDatabase(fromhost)<br>    <span class="hljs-keyword">db</span>.commandHelp(name) returns the <span class="hljs-keyword">help</span> <span class="hljs-keyword">for</span> the command<br>    <span class="hljs-keyword">db</span>.copyDatabase(fromdb, todb, fromhost)<br>    <span class="hljs-keyword">db</span>.createCollection(name, &#123;size: ..., capped: ..., max: ...&#125;)<br>    <span class="hljs-keyword">db</span>.createView(name, viewOn, [&#123;<span class="hljs-variable">$operator</span>: &#123;...&#125;&#125;, ...], &#123;viewOptions&#125;)<br>    <span class="hljs-keyword">db</span>.createUser(userDocument)<br>    <span class="hljs-keyword">db</span>.currentOp() displays currently executing operations <span class="hljs-keyword">in</span> the <span class="hljs-keyword">db</span><br>    <span class="hljs-keyword">db</span>.dropDatabase()<br>    <span class="hljs-keyword">db</span>.eval() - deprecated<br>    <span class="hljs-keyword">db</span>.fsyncLock() flush data to disk and lock server <span class="hljs-keyword">for</span> backups<br>    <span class="hljs-keyword">db</span>.fsyncUnlock() unlocks server following a <span class="hljs-keyword">db</span>.fsyncLock()<br>    <span class="hljs-keyword">db</span>.getCollection(cname) same <span class="hljs-keyword">as</span> <span class="hljs-keyword">db</span>[&#x27;cname&#x27;] or <span class="hljs-keyword">db</span>.cname<br>    <span class="hljs-keyword">db</span>.getCollectionInfos([filter]) - returns a <span class="hljs-keyword">list</span> that contains the names and options of the <span class="hljs-keyword">db</span>&#x27;s collections<br>    <span class="hljs-keyword">db</span>.getCollectionNames()<br>    <span class="hljs-keyword">db</span>.getLastError() - just returns the <span class="hljs-keyword">err</span> msg string<br>    <span class="hljs-keyword">db</span>.getLastErrorObj() - <span class="hljs-keyword">return</span> full status object<br>    <span class="hljs-keyword">db</span>.getLogComponents()<br>    <span class="hljs-keyword">db</span>.getMongo() get the server connection object<br>    <span class="hljs-keyword">db</span>.getMongo().setSlaveOk() allow queries <span class="hljs-keyword">on</span> a replication slave server<br>    <span class="hljs-keyword">db</span>.getName()<br>    <span class="hljs-keyword">db</span>.getPrevError()<br>    <span class="hljs-keyword">db</span>.getProfilingLevel() - deprecated<br>    <span class="hljs-keyword">db</span>.getProfilingStatus() - returns <span class="hljs-keyword">if</span> profiling is <span class="hljs-keyword">on</span> and slow threshold<br>    <span class="hljs-keyword">db</span>.getReplicationInfo()<br>    <span class="hljs-keyword">db</span>.getSiblingDB(name) get the <span class="hljs-keyword">db</span> at the same server <span class="hljs-keyword">as</span> this <span class="hljs-keyword">one</span><br>    <span class="hljs-keyword">db</span>.getWriteConcern() - returns the write concern used <span class="hljs-keyword">for</span> any operations <span class="hljs-keyword">on</span> this <span class="hljs-keyword">db</span>, inherited from server object <span class="hljs-keyword">if</span> <span class="hljs-keyword">set</span><br>    <span class="hljs-keyword">db</span>.hostInfo() get details <span class="hljs-keyword">about</span> the server&#x27;s host<br>    <span class="hljs-keyword">db</span>.isMaster() check replica primary status<br>    <span class="hljs-keyword">db</span>.killOp(opid) kills the current operation <span class="hljs-keyword">in</span> the <span class="hljs-keyword">db</span><br>    <span class="hljs-keyword">db</span>.listCommands() lists all the <span class="hljs-keyword">db</span> commands<br>    <span class="hljs-keyword">db</span>.loadServerScripts() loads all the scripts <span class="hljs-keyword">in</span> <span class="hljs-keyword">db</span>.system.js<br>    <span class="hljs-keyword">db</span>.logout()<br>    <span class="hljs-keyword">db</span>.printCollectionStats()<br>    <span class="hljs-keyword">db</span>.printReplicationInfo()<br>    <span class="hljs-keyword">db</span>.printShardingStatus()<br>    <span class="hljs-keyword">db</span>.printSlaveReplicationInfo()<br>    <span class="hljs-keyword">db</span>.dropUser(username)<br>    <span class="hljs-keyword">db</span>.repairDatabase()<br>    <span class="hljs-keyword">db</span>.resetError()<br>    <span class="hljs-keyword">db</span>.runCommand(cmdObj) <span class="hljs-keyword">run</span> a database command.  <span class="hljs-keyword">if</span> cmdObj is a string, turns it into &#123;cmdObj: 1&#125;<br>    <span class="hljs-keyword">db</span>.serverStatus()<br>    <span class="hljs-keyword">db</span>.setLogLevel(level,)<br>    <span class="hljs-keyword">db</span>.setProfilingLevel(level,slowms) 0=off 1=slow 2=all<br>    <span class="hljs-keyword">db</span>.setWriteConcern() - sets the write concern <span class="hljs-keyword">for</span> writes to the <span class="hljs-keyword">db</span><br>    <span class="hljs-keyword">db</span>.unsetWriteConcern() - unsets the write concern <span class="hljs-keyword">for</span> writes to the <span class="hljs-keyword">db</span><br>    <span class="hljs-keyword">db</span>.setVerboseShell(flag) <span class="hljs-keyword">display</span> extra information <span class="hljs-keyword">in</span> <span class="hljs-keyword">shell</span> output<br>    <span class="hljs-keyword">db</span>.shutdownServer()<br>    <span class="hljs-keyword">db</span>.stats()<br>    <span class="hljs-keyword">db</span>.<span class="hljs-keyword">version</span>() current <span class="hljs-keyword">version</span> of the server<br></code></pre></td></tr></table></figure>

<p><code>db.集合名.help()</code> ：集合相关的帮助命令</p>
<p>example：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs stata">&gt; <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">help</span>()<br>DBCollection <span class="hljs-keyword">help</span><br>    <span class="hljs-keyword">db</span>.php.find().<span class="hljs-keyword">help</span>() - show DBCursor <span class="hljs-keyword">help</span><br>    <span class="hljs-keyword">db</span>.php.bulkWrite( operations,  ) - bulk execute write operations, optional parameters are: w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">count</span>( <span class="hljs-keyword">query</span> = &#123;&#125;,  ) - <span class="hljs-keyword">count</span> the number of documents that matches the <span class="hljs-keyword">query</span>, optional parameters are: limit, skip, hint, maxTimeMS<br>    <span class="hljs-keyword">db</span>.php.copyTo(newColl) - <span class="hljs-keyword">duplicates</span> collection <span class="hljs-keyword">by</span> copying all documents to newColl; <span class="hljs-keyword">no</span> indexes are copied.<br>    <span class="hljs-keyword">db</span>.php.convertToCapped(maxBytes) - calls &#123;convertToCapped:&#x27;php&#x27;, size:maxBytes&#125;&#125; command<br>    <span class="hljs-keyword">db</span>.php.createIndex(keypattern[,options])<br>    <span class="hljs-keyword">db</span>.php.createIndexes([keypatterns], )<br>    <span class="hljs-keyword">db</span>.php.dataSize()<br>    <span class="hljs-keyword">db</span>.php.deleteOne( filter,  ) - delete first matching document, optional parameters are: w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.deleteMany( filter,  ) - delete all matching documents, optional parameters are: w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">distinct</span>( key, <span class="hljs-keyword">query</span>,  ) - <span class="hljs-keyword">e</span>.<span class="hljs-keyword">g</span>. <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">distinct</span>( &#x27;x&#x27; ), optional parameters are: maxTimeMS<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">drop</span>() <span class="hljs-keyword">drop</span> the collection<br>    <span class="hljs-keyword">db</span>.php.dropIndex(index) - <span class="hljs-keyword">e</span>.<span class="hljs-keyword">g</span>. <span class="hljs-keyword">db</span>.php.dropIndex( <span class="hljs-string">&quot;indexName&quot;</span> ) or <span class="hljs-keyword">db</span>.php.dropIndex( &#123; <span class="hljs-string">&quot;indexKey&quot;</span> : 1 &#125; )<br>    <span class="hljs-keyword">db</span>.php.dropIndexes()<br>    <span class="hljs-keyword">db</span>.php.ensureIndex(keypattern[,options]) - DEPRECATED, <span class="hljs-keyword">use</span> createIndex() instead<br>    <span class="hljs-keyword">db</span>.php.explain().<span class="hljs-keyword">help</span>() - show explain <span class="hljs-keyword">help</span><br>    <span class="hljs-keyword">db</span>.php.reIndex()<br>    <span class="hljs-keyword">db</span>.php.find([<span class="hljs-keyword">query</span>],[fields]) - <span class="hljs-keyword">query</span> is <span class="hljs-keyword">an</span> optional <span class="hljs-keyword">query</span> filter. fields is optional <span class="hljs-keyword">set</span> of fields to <span class="hljs-keyword">return</span>.<br>                                                  <span class="hljs-keyword">e</span>.<span class="hljs-keyword">g</span>. <span class="hljs-keyword">db</span>.php.find( &#123;x:77&#125; , &#123;name:1, x:1&#125; )<br>    <span class="hljs-keyword">db</span>.php.find(...).<span class="hljs-keyword">count</span>()<br>    <span class="hljs-keyword">db</span>.php.find(...).limit(<span class="hljs-keyword">n</span>)<br>    <span class="hljs-keyword">db</span>.php.find(...).skip(<span class="hljs-keyword">n</span>)<br>    <span class="hljs-keyword">db</span>.php.find(...).<span class="hljs-keyword">sort</span>(...)<br>    <span class="hljs-keyword">db</span>.php.findOne([<span class="hljs-keyword">query</span>], [fields], [options], [readConcern])<br>    <span class="hljs-keyword">db</span>.php.findOneAndDelete( filter,  ) - delete first matching document, optional parameters are: projection, <span class="hljs-keyword">sort</span>, maxTimeMS<br>    <span class="hljs-keyword">db</span>.php.findOneAndReplace( filter, replacement,  ) - <span class="hljs-keyword">replace</span> first matching document, optional parameters are: projection, <span class="hljs-keyword">sort</span>, maxTimeMS, upsert, returnNewDocument<br>    <span class="hljs-keyword">db</span>.php.findOneAndUpdate( filter, <span class="hljs-keyword">update</span>,  ) - <span class="hljs-keyword">update</span> first matching document, optional parameters are: projection, <span class="hljs-keyword">sort</span>, maxTimeMS, upsert, returnNewDocument<br>    <span class="hljs-keyword">db</span>.php.getDB() get <span class="hljs-keyword">DB</span> object associated with collection<br>    <span class="hljs-keyword">db</span>.php.getPlanCache() get <span class="hljs-keyword">query</span> plan cache associated with collection<br>    <span class="hljs-keyword">db</span>.php.getIndexes()<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-built_in">group</span>( &#123; key : ..., initial: ..., reduce : ...[, cond: ...] &#125; )<br>    <span class="hljs-keyword">db</span>.php.insert(obj)<br>    <span class="hljs-keyword">db</span>.php.insertOne( obj,  ) - insert a document, optional parameters are: w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.insertMany( [objects],  ) - insert multiple documents, optional parameters are: w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.mapReduce( mapFunction , reduceFunction ,  )<br>    <span class="hljs-keyword">db</span>.php.aggregate( [pipeline],  ) - performs <span class="hljs-keyword">an</span> aggregation <span class="hljs-keyword">on</span> a collection; returns a cursor<br>    <span class="hljs-keyword">db</span>.php.remove(<span class="hljs-keyword">query</span>)<br>    <span class="hljs-keyword">db</span>.php.replaceOne( filter, replacement,  ) - <span class="hljs-keyword">replace</span> the first matching document, optional parameters are: upsert, w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.renameCollection( newName ,  ) renames the collection.<br>    <span class="hljs-keyword">db</span>.php.runCommand( name ,  ) runs a <span class="hljs-keyword">db</span> command with the given name where the first param is the collection name<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">save</span>(obj)<br>    <span class="hljs-keyword">db</span>.php.stats(&#123;scale: <span class="hljs-keyword">N</span>, indexDetails: true/false, indexDetailsKey: , indexDetailsName: &#125;)<br>    <span class="hljs-keyword">db</span>.php.storageSize() - includes free space allocated to this collection<br>    <span class="hljs-keyword">db</span>.php.totalIndexSize() - size <span class="hljs-keyword">in</span> bytes of all the indexes<br>    <span class="hljs-keyword">db</span>.php.totalSize() - storage allocated <span class="hljs-keyword">for</span> all data and indexes<br>    <span class="hljs-keyword">db</span>.php.<span class="hljs-keyword">update</span>( <span class="hljs-keyword">query</span>, object[, upsert_bool, multi_bool] ) - instead of <span class="hljs-keyword">two</span> flags, you can pass <span class="hljs-keyword">an</span> object with fields: upsert, multi<br>    <span class="hljs-keyword">db</span>.php.updateOne( filter, <span class="hljs-keyword">update</span>,  ) - <span class="hljs-keyword">update</span> the first matching document, optional parameters are: upsert, w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.updateMany( filter, <span class="hljs-keyword">update</span>,  ) - <span class="hljs-keyword">update</span> all matching documents, optional parameters are: upsert, w, wtimeout, j<br>    <span class="hljs-keyword">db</span>.php.validate(  ) - SLOW<br>    <span class="hljs-keyword">db</span>.php.getShardVersion() - only <span class="hljs-keyword">for</span> <span class="hljs-keyword">use</span> with sharding<br>    <span class="hljs-keyword">db</span>.php.getShardDistribution() - prints statistics <span class="hljs-keyword">about</span> data distribution <span class="hljs-keyword">in</span> the <span class="hljs-keyword">cluster</span><br>    <span class="hljs-keyword">db</span>.php.getSplitKeysForChunks(  ) - calculates <span class="hljs-keyword">split</span> points over all chunks and returns splitter function<br>    <span class="hljs-keyword">db</span>.php.getWriteConcern() - returns the write concern used <span class="hljs-keyword">for</span> any operations <span class="hljs-keyword">on</span> this collection, inherited from server/<span class="hljs-keyword">db</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">set</span><br>    <span class="hljs-keyword">db</span>.php.setWriteConcern(  ) - sets the write concern <span class="hljs-keyword">for</span> writes to the collection<br>    <span class="hljs-keyword">db</span>.php.unsetWriteConcern(  ) - unsets the write concern <span class="hljs-keyword">for</span> writes to the collection<br>    <span class="hljs-keyword">db</span>.php.latencyStats() - <span class="hljs-keyword">display</span> operation latency histograms <span class="hljs-keyword">for</span> this collection<br></code></pre></td></tr></table></figure>



<h3 id="四、增删改查操作"><a href="#四、增删改查操作" class="headerlink" title="四、增删改查操作"></a>四、增删改查操作</h3><h5 id="1、添加文档"><a href="#1、添加文档" class="headerlink" title="1、添加文档"></a>1、添加文档</h5><p><code>db.集合名.insert(&#123;k1:v1,k2:v2...&#125;)</code> ：向当前数据库的该集合下添加文档</p>
<p>我们在添加文档的时候有如下注意点：</p>
<p>a) 文档就是键值对，数据类型是 <code>BSON</code> 格式，支持的值更加丰富。 <code>BSON</code> 是 <code>JSON</code> 的扩展，新增了诸如日期，浮点等 <code>JSON</code> 不支持的数据类型。</p>
<p>b) 在添加的文档里面，都有一个 <code>&#39;_id&#39;</code> 的键，值为对象类型 <code>ObjectID</code> ，在这里，我们解释下 <code>ObjectID</code> 类型：</p>
<p>每个文档都有一个 <code>_id</code> 字段，并且同一集合中的 <code>_id</code> 值唯一，该字段可以是任意类型的数据，默认是一个 <code>ObjectID</code> 对象。<br><code>ObjectID</code> 对象数据组成：时间戳|机器码|PID|计数器<br><code>_id</code> 的键值我们可以自己输入，但是不能重复，但要注意的一点是在插入数据的时候，如果 <code>_id</code> 的值重复则会报错</p>
<p>c) 可以使用 <code>js</code> 代码来完成批量插入文档</p>
<p>example：</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt; for(<span class="hljs-name">var</span> i=1<span class="hljs-comment">;i&lt;=10;i++)&#123;</span><br>... db.php.insert(&#123;&#x27;name&#x27;:&#x27;xiaobai&#x27;+i,&#x27;age&#x27;<span class="hljs-symbol">:i</span>,&#x27;email&#x27;:&#x27;xiaobai&#x27;+i+&#x27;@gmail.com&#x27;&#125;)<br>... &#125;<br>WriteResult(&#123; <span class="hljs-string">&quot;nInserted&quot;</span> : <span class="hljs-number">1</span> &#125;)<br>&gt; db.php.find()<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931b74a39e4f4842ba36b3&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoming&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">20</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaoming@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaohong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">18</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaohong@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36b5&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai1&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">1</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai1@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36b6&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai2&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">2</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai2@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36b7&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai3&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">3</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai3@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36b8&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai4&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">4</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai4@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36b9&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai5&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">5</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai5@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai6&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">6</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai6@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai7&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">7</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai7@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bc&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai8&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">8</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai8@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai9&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">9</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai9@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36be&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai10&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">10</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai10@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<h5 id="2、删除文档"><a href="#2、删除文档" class="headerlink" title="2、删除文档"></a>2、删除文档</h5><p><code>db.集合名.remove&#123;(条件)&#125;</code> ：删除当前数据库下指定集合中满足条件的文档(不写条件则删除所有的文档)</p>
<p>example：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.remove</span>(&#123;age:<span class="hljs-number">20</span>&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nRemoved&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.remove</span>(&#123;age:&#123;<span class="hljs-string">&#x27;$lt&#x27;</span>:<span class="hljs-number">6</span>&#125;&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nRemoved&quot;</span> : <span class="hljs-number">5</span> &#125;)</span></span><br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaohong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">18</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaohong@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai6&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">6</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai6@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai7&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">7</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai7@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bc&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai8&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">8</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai8@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai9&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">9</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai9@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36be&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai10&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">10</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai10@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>这里我们在删除 <code>php</code> 集合中年龄小于6的文档时，我们使用了操作符来完成。</p>
<p><strong>比较运算符</strong></p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td><code>$gt</code></td>
<td>大于</td>
</tr>
<tr>
<td><code>$lt</code></td>
<td>小于</td>
</tr>
<tr>
<td><code>$gte</code></td>
<td>大于等于</td>
</tr>
<tr>
<td><code>$lte</code></td>
<td>小于等于</td>
</tr>
<tr>
<td><code>$exists</code></td>
<td>存在与否</td>
</tr>
<tr>
<td><code>$in</code></td>
<td>包含</td>
</tr>
<tr>
<td><code>$ne</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>$nin</code></td>
<td>不包含</td>
</tr>
</tbody></table>
<p><strong>逻辑运算符</strong></p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td><code>$exists</code></td>
<td>存在与否</td>
</tr>
<tr>
<td><code>$or</code></td>
<td>或者</td>
</tr>
<tr>
<td><code>$and</code></td>
<td>并且</td>
</tr>
<tr>
<td><code>$not</code></td>
<td>不存在</td>
</tr>
<tr>
<td><code>$mod</code></td>
<td>求模</td>
</tr>
<tr>
<td><code>$where</code></td>
<td>位置</td>
</tr>
</tbody></table>
<blockquote>
<p>特别的 $exists: true 表示字段存在</p>
</blockquote>
<p><strong>排序 sort</strong></p>
<table>
<thead>
<tr>
<th>操作</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td><code>$asc</code></td>
<td>升序</td>
</tr>
<tr>
<td><code>$desc</code></td>
<td>降序</td>
</tr>
</tbody></table>
<h5 id="3、更新文档"><a href="#3、更新文档" class="headerlink" title="3、更新文档"></a>3、更新文档</h5><p>更新文档有两种方式进行修改</p>
<p>方法一、直接修改</p>
<p><code>db.集合名.update(&#123;条件&#125;,&#123;新的文档&#125;)</code> ：修改当前数据库下指定集合中满足条件的文档信息</p>
<p>example：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaohong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">18</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaohong@gmail.com&quot;</span> &#125;<br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.update</span>(&#123;age:<span class="hljs-number">18</span>&#125;,&#123;name:<span class="hljs-string">&#x27;xiaobai5&#x27;</span>&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nMatched&quot;</span> : <span class="hljs-number">1</span>, <span class="hljs-string">&quot;nUpserted&quot;</span> : <span class="hljs-number">0</span>, <span class="hljs-string">&quot;nModified&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai5&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p><code>db.集合.update(条件,新文档,是否新增,是否修改多条)</code> ：修改当前数据库下指定集合中满足条件的文档信息</p>
<ul>
<li>是否新增：如果值是1(true)则没有满足条件的 则添加</li>
<li>是否修改多条：若值是1(true)，如果满足条件的有多个文档 则都要修改</li>
</ul>
<p>example：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ada">&gt; db.php.update(&#123;age:<span class="hljs-number">10</span>&#125;,&#123;name:<span class="hljs-symbol">&#x27;xiaoli</span>&#x27;&#125;,<span class="hljs-literal">true</span>,<span class="hljs-literal">true</span>)<br>WriteResult(&#123;<br>    <span class="hljs-string">&quot;nMatched&quot;</span> : 0,<br>    <span class="hljs-string">&quot;nUpserted&quot;</span> : 0,<br>    <span class="hljs-string">&quot;nModified&quot;</span> : 0,<br>    <span class="hljs-string">&quot;writeError&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;code&quot;</span> : 9,<br>        <span class="hljs-string">&quot;errmsg&quot;</span> : &quot;<span class="hljs-type">multi</span> update only works <span class="hljs-keyword">with</span> $ operators<span class="hljs-string">&quot;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;)</span><br></code></pre></td></tr></table></figure>

<p>方法二、使用修改器</p>
<p>example：</p>
<p>我们要修改 <code>age=6</code> 的文档名称为 <code>xiaosan</code> ，并且其他键值不能丢失</p>
<p>我们可以使用修改器</p>
<ul>
<li><code>$inc</code> ：加上一个数字</li>
<li><code>$set</code> ：修改某一个字段，如果该字段不存在就增这个字段</li>
</ul>
<p>语法：<code>db.集合名.update(&#123;条件&#125;,&#123;修改器名称:&#123;修改的键:修改的新值&#125;&#125;)</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.update</span>(&#123;age:<span class="hljs-number">6</span>&#125;,&#123;<span class="hljs-string">&#x27;$set&#x27;</span>:&#123;name:<span class="hljs-string">&#x27;xiaosan&#x27;</span>&#125;&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nMatched&quot;</span> : <span class="hljs-number">1</span>, <span class="hljs-string">&quot;nUpserted&quot;</span> : <span class="hljs-number">0</span>, <span class="hljs-string">&quot;nModified&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br></code></pre></td></tr></table></figure>

<p>那如果我们要修改 <code>age=10</code> 的文档的年龄增加十岁，我们可以这样做：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.update</span>(&#123;age:<span class="hljs-number">10</span>&#125;,&#123;<span class="hljs-variable">$inc</span>:&#123;age:<span class="hljs-number">10</span>&#125;&#125;)<br><span class="hljs-function"><span class="hljs-title">WriteResult</span><span class="hljs-params">(&#123; <span class="hljs-string">&quot;nMatched&quot;</span> : <span class="hljs-number">1</span>, <span class="hljs-string">&quot;nUpserted&quot;</span> : <span class="hljs-number">0</span>, <span class="hljs-string">&quot;nModified&quot;</span> : <span class="hljs-number">1</span> &#125;)</span></span><br></code></pre></td></tr></table></figure>

<h5 id="4、查询文档"><a href="#4、查询文档" class="headerlink" title="4、查询文档"></a>4、查询文档</h5><p>语法： <code>db.集合名.find(&#123;条件&#125;)</code></p>
<p>example：</p>
<p>取出 <code>php</code> 集合里面的第一个文档</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&gt; db.php.find<span class="hljs-constructor">One()</span><br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-constructor">ObjectId(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>)</span>, <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai5&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>取出 <code>php</code> 集合里面 <code>age=6</code> 的文档</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>(&#123;age:<span class="hljs-number">6</span>&#125;)<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaosan&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">6</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai6@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>取出 <code>php</code> 集合里面 <code>age&gt;8</code> 的文档</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>(&#123;age:&#123;<span class="hljs-string">&#x27;$gt&#x27;</span>:<span class="hljs-number">8</span>&#125;&#125;)<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai9&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">9</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai9@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36be&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai10&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">20</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai10@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>取出 <code>php</code> 集合里面的文档，只显示 <code>name</code> 键</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>(&#123;&#125;,&#123;age:<span class="hljs-number">1</span>&#125;)//<span class="hljs-number">1</span>表示只显示age键值<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>) &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">6</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">7</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bc&quot;</span>), <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">8</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">9</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36be&quot;</span>), <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">20</span> &#125;<br>&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>(&#123;&#125;,&#123;age:<span class="hljs-number">0</span>&#125;)//<span class="hljs-number">1</span>表示除了显示age键值，其他的都显示<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai5&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaosan&quot;</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai6@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai7&quot;</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai7@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bc&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai8&quot;</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai8@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai9&quot;</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai9@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36be&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai10&quot;</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai10@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>根据年龄的(降序|升序)来显示文档</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dos">db.集合名.<span class="hljs-built_in">find</span>().<span class="hljs-built_in">sort</span>(&#123;age:<span class="hljs-number">1</span>&#125;)根据年龄升序<br>db.集合名.<span class="hljs-built_in">find</span>().<span class="hljs-built_in">sort</span>(&#123;age:<span class="hljs-number">0</span>&#125;)根据年龄降序<br></code></pre></td></tr></table></figure>

<p>显示 <code>php</code> 集合中的前三个文档</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<span class="hljs-selector-class">.limit</span>(<span class="hljs-number">3</span>)<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931b7ca39e4f4842ba36b4&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai5&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36ba&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaosan&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">6</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai6@gmail.com&quot;</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai7&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">7</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai7@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>显示 <code>php</code> 集合中的第三个文档到第五个文档</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt; db<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.find</span>()<span class="hljs-selector-class">.skip</span>(<span class="hljs-number">2</span>)<span class="hljs-selector-class">.limit</span>(<span class="hljs-number">3</span>)<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bb&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai7&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">7</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai7@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bc&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai8&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">8</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai8@gmail.com&quot;</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5b931dfba39e4f4842ba36bd&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaobai9&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">9</span>, <span class="hljs-string">&quot;email&quot;</span> : <span class="hljs-string">&quot;xiaobai9@gmail.com&quot;</span> &#125;<br></code></pre></td></tr></table></figure>

<p>统计 <code>php</code> 集合中文档的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">db.集合名.<span class="hljs-built_in">count</span>():返回集合中有多少个文档<br></code></pre></td></tr></table></figure>



<h3 id="五、用户管理-权限控制"><a href="#五、用户管理-权限控制" class="headerlink" title="五、用户管理(权限控制)"></a>五、用户管理(权限控制)</h3><h5 id="1、权限概述"><a href="#1、权限概述" class="headerlink" title="1、权限概述"></a>1、权限概述</h5><p>在 <code>MongoDB</code> 里面的用户是属于数据库的，每个数据库都有自己的管理员。管理员登录后，只能操作所属的数据库。注意：在 <code>admin</code> 的数据库中创建的用户是超级管理员，登陆后可以操作任何的数据库</p>
<h5 id="2、创建用户"><a href="#2、创建用户" class="headerlink" title="2、创建用户"></a>2、创建用户</h5><p>(1) 选择数据库</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">use</span> 数据库的名称<br></code></pre></td></tr></table></figure>

<p>(2) 添加用户</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">db.createUser<span class="hljs-comment">(用户名,密码,是否只读)</span><br></code></pre></td></tr></table></figure>

<p>第三个参数”是否只读”默认是 <code>false</code> ，创建的用户可以执行读写，如果是 <code>true</code> ，则创建的用户只能查询，不能修改。</p>
<p>注意点：在创建用户之前，必须先创建一个超级管理员</p>
<p>example：</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">use admin</span><br>switched to db admin<br><span class="hljs-meta">&gt;</span> <span class="javascript">db.createUser(&#123;<span class="hljs-attr">user</span>:<span class="hljs-string">&#x27;user&#x27;</span>,</span><br><span class="hljs-meta">...</span> <span class="javascript"> pwd:<span class="hljs-string">&#x27;passwd&#x27;</span>, </span><br><span class="hljs-meta">...</span> <span class="javascript"> roles:[</span><br><span class="hljs-meta">...</span> <span class="javascript">   &#123;<span class="hljs-attr">role</span>:<span class="hljs-string">&#x27;userAdminAnyDatabase&#x27;</span>, <span class="hljs-attr">db</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;</span><br><span class="hljs-meta">...</span> <span class="javascript">]</span><br><span class="hljs-meta">...</span> <span class="javascript">&#125;)</span><br>Successfully added user: &#123;<br>    &quot;user&quot; : &quot;user&quot;,<br>    &quot;roles&quot; : [<br>        &#123;<br>            &quot;role&quot; : &quot;userAdminAnyDatabase&quot;,<br>            &quot;db&quot; : &quot;admin&quot;<br>        &#125;<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3、验证权限-用户登录"><a href="#3、验证权限-用户登录" class="headerlink" title="3、验证权限(用户登录)"></a>3、验证权限(用户登录)</h5><p>在添加完成管理员之后，我们做如下操作：</p>
<p>(1) 如果你是安装成windows服务的方式安装的，则卸载服务，在安装时添加一个 <code>-auth</code> 选项，<code>auth</code> 表示要开启权限认证</p>
<p>(2) 如果你是直接启动的方式，则停止服务，重新启动，在启动时也要添加 <code>--auth</code> 选项，<code>auth</code> 表示要开启权限认证</p>
<p>如果没有通过权限验证，直接操作数据库，则报如下错误提示：</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">error: </span>&#123;<br>       &quot;$err&quot; : &quot;unauthorized db:test lock type:<span class="hljs-string">-1</span> client:127.0.0.1&quot;,<br>        &quot;code&quot; : 10057<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如何通过权限验证</p>
<ol>
<li>选择数据库</li>
<li>执行<code>db.auth</code> (用户名,密码)</li>
</ol>
<h5 id="4、删除用户和修改密码"><a href="#4、删除用户和修改密码" class="headerlink" title="4、删除用户和修改密码"></a>4、删除用户和修改密码</h5><p>注意：创建的用户名和密码是存储在各自数据库里面的 <code>system.users</code> 集合里面的。想要删除用户，则直接删除 <code>system.users</code> 集合里面的文档即可</p>
<h5 id="5、总结说明"><a href="#5、总结说明" class="headerlink" title="5、总结说明"></a>5、总结说明</h5><p>a) 非 <code>admin</code> 数据库的用户不能使用数据库命令，比如 <code>show dbs</code> 等</p>
<p>(b) <code>admin</code> 数据库中的用户被视为超级用户(即管理员)，在认证之后，管理员可以读写所有数据库，执行特定的管理命令。</p>
<p>(c) 在开启安全检查之前，一定要至少有个管理员账户。</p>
<p>(d) 数据库的用户账号以文档的形式存储在 <code>system.users</code> 集合里面。可以在 <code>system.users</code> 集合中删除用户账号文档，就可以删除用户。</p>
<h3 id="六、MongoDB中的索引"><a href="#六、MongoDB中的索引" class="headerlink" title="六、MongoDB中的索引"></a>六、MongoDB中的索引</h3><p>1、普通单列索引</p>
<p>我们用如下代码来测试：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">for</span><span class="hljs-params">(var i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">200000</span>;i++)</span></span>&#123;<br>    db<span class="hljs-selector-class">.java</span><span class="hljs-selector-class">.insert</span>(&#123;name:<span class="hljs-string">&#x27;xiao&#x27;</span>+<span class="hljs-selector-tag">i</span>,age:i&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>第一、我们先检验一下查询性能</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">var start=<span class="hljs-built_in">new</span> <span class="hljs-type">Date</span>()<br>db.java.find(&#123;<span class="hljs-type">name</span>:<span class="hljs-string">&#x27;xiao156789&#x27;</span>&#125;)<br>var end=<span class="hljs-built_in">new</span> <span class="hljs-type">Date</span>()<br><span class="hljs-keyword">end</span>-<span class="hljs-keyword">start</span><br><span class="hljs-number">17510</span><br></code></pre></td></tr></table></figure>

<p>第二、为 <code>name</code> 创建索引</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ada">&gt; db.java.ensureIndex(&#123;name:<span class="hljs-number">1</span>&#125;)<br>&#123;<br>    <span class="hljs-string">&quot;createdCollectionAutomatically&quot;</span> : <span class="hljs-type">false</span>,<br>    <span class="hljs-string">&quot;numIndexesBefore&quot;</span> : 1,<br>    <span class="hljs-string">&quot;numIndexesAfter&quot;</span> : 2,<br>    <span class="hljs-string">&quot;ok&quot;</span> : 1<br>&#125;<br></code></pre></td></tr></table></figure>

<p>第三、再执行第一部分代码可以看出有数量级的性能提升</p>
<p>语法：<code>db.集合名.ensureIndex(&#123;键名:1&#125;)</code> ：1是升序，-1是降序</p>
<p>2、多列索引(复合索引)</p>
<p>创建多列索引<br>语法：<code>db.集合名.ensureIndex(&#123;field1:1/-1,field2:1/-1&#125;)</code><br>对 <code>name</code> 和 <code>age</code> 建立一个复合索引，可以使用 <code>db.集合名.getIndexes()</code> 查看创建的索引情况</p>
<p>3、子文档索引</p>
<p>语法： <code>db.集合名.ensureIndex(&#123;field.subfield:1/-1&#125;)</code><br>如下文档可以建立子文档索引</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">&#123;name:<span class="hljs-string">&#x27;诺基亚手机1&#x27;</span>,price:<span class="hljs-number">12.34</span>,spc:&#123;weigh<span class="hljs-variable">t:100</span>,are<span class="hljs-variable">a:</span><span class="hljs-string">&#x27;纽约&#x27;</span>&#125;&#125;<br>&#123;name:<span class="hljs-string">&#x27;诺基亚手机2&#x27;</span>,price:<span class="hljs-number">42.34</span>,spc:&#123;weigh<span class="hljs-variable">t:200</span>,are<span class="hljs-variable">a:</span><span class="hljs-string">&#x27;伦敦&#x27;</span>&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>比如要查询 <code>weight=100</code> 的文档</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">db.goods.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;spc.weight&#x27;</span>:100&#125;)<br></code></pre></td></tr></table></figure>

<p>根据当前案例，我们建立子文档索引</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">db.net.ensure<span class="hljs-constructor">Index(&#123;&#x27;<span class="hljs-params">spc</span>.<span class="hljs-params">w</span>&#x27;:1&#125;)</span><br></code></pre></td></tr></table></figure>

<p>4、唯一索引</p>
<p>语法： <code>db.集合名.ensureIndex(&#123;name:-1&#125;,&#123;unique:true&#125;)</code></p>
<p>5、查看索引</p>
<p>(1) 查看当前索引状态： <code>db.集合名.getIndexes()</code></p>
<p>(2) 详情查看本次查询使用哪个索引和查询数据的状态信息： <code>db.集合名.find(&#123;name:&#39;&#39;xiao&#125;).explain()</code></p>
<p>6、删除索引</p>
<p>删除单个索引： <code>db.集合名.dropIndex(&#123;filed:1/-1&#125;)</code></p>
<p>删除所有索引： <code>db.集合名.dropIndexes()</code></p>
<p>7、重建索引</p>
<p>一个表经过很多次修改后，导致表的文件产生空洞，索引文件也如此，可以通过索引的重建，减少索引文件碎片，并提高索引的效率，类似 <code>mysql</code> 中的 <code>optimize table</code> 。</p>
<p><code>mysql</code> 里面使用 <code>optimize table</code> 语法： <code>optimize table</code> 表名</p>
<p>语法： <code>db.集合名.reIndex()</code></p>
<p>8、索引使用注意事项</p>
<p>(1) 创建索引的时候，注意1是正序创建索引，-1是倒序创建索引</p>
<p>(2) 索引的创建在提高查询性能的同时会影响插入性能，对于经常查询少插入</p>
<p>(3) 复合索引要注意索引的先后顺序</p>
<p>(4) 每个键全建立索引不一定就能提高性能，索引不是万能的。</p>
<p>(5) 在做排序工作的时候如果是超大数据量也可以考虑加上索引用来提高排序的性能。</p>
<h3 id="八、MongoDB中的数据导出与导出"><a href="#八、MongoDB中的数据导出与导出" class="headerlink" title="八、MongoDB中的数据导出与导出"></a>八、MongoDB中的数据导出与导出</h3><p>利用mongoexport</p>
<ul>
<li>-h host主机</li>
<li>-port 端口</li>
<li>-d 指明使用的库</li>
<li>-o 指明要导出的文件名</li>
<li>-csv 指定导出的csv格式</li>
<li>-q 过滤导出</li>
<li>-f field1 field2 列名</li>
<li>-u username 用户名</li>
<li>-p password 密码</li>
</ul>
<p>注意：在使用用户名和密码是超级管理员的时候，如果端口是默认的可以不使用-port来指定端口</p>
<p>(2) 导入数据</p>
<ul>
<li>-d 待导入的数据库</li>
<li>-c 待导入的集合(不存在会自己创建)</li>
<li>-type csv/json(默认)</li>
<li>-file 备份文件路径</li>
</ul>
<p>例如：导入json</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">.<span class="hljs-regexp">/bin/m</span>ongoimport -h -port 端口号 -d test -c goods -<span class="hljs-keyword">file</span> ./goodsall.json<br></code></pre></td></tr></table></figure>

<p>导入csv</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">./bin/mongoimport -h -port 端口号 -d test -c goods -type csv -f goods.<span class="hljs-built_in">id</span>,goods.<span class="hljs-built_in">name</span> -<span class="hljs-built_in">file</span> ./goodsall.csv<br><br>./bin/mongoimport -h -port 端口号 -d test -c goods -type csv -f -headline -f goods.<span class="hljs-built_in">id</span>,goods.<span class="hljs-built_in">name</span> -<span class="hljs-built_in">file</span> ./goodsall.csv<br></code></pre></td></tr></table></figure>



<h3 id="九、主从复制-读写分离"><a href="#九、主从复制-读写分离" class="headerlink" title="九、主从复制(读写分离)"></a>九、主从复制(读写分离)</h3><p>主从复制是一个简单的数据库同步备份的集群技术，至少两台数据库服务器，可以分别设置主服务器和从服务器，对主服务器的任何操作都会同步到从服务器上。</p>
<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114304941-156604371.png" srcset="/img/loading.gif" lazyload alt="主从1"></p>
<p><img src="https://img2018.cnblogs.com/blog/1100338/201809/1100338-20180909114303961-459207762.png" srcset="/img/loading.gif" lazyload alt="主从2"></p>
<p>实现的注意点</p>
<p>1、在数据库集群中要明确的知道谁是主服务器，主服务器只有一台</p>
<p>2、从服务器要知道自己的数据源 也就是对应的主服务是谁</p>
<p>3、–master用来确定主服务器 –slave和–source来控制从服务器</p>
<p>配置步骤</p>
<p>(1) 启动主服务器</p>
<p>(2) 启动从服务器</p>
<p>(3) 客户端登录到主服务器</p>
<p>添加一些数据，测试是否同步到从服务器，在主服务器里面，添加了一些文档：</p>
<p>第一步，客户端登录到主服务器，添加一些文档</p>
<p>第二步，登录到从服务器，查看是否有数据，如果有数据，则成功了！</p>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/db/" class="category-chain-item">db</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MongoDB/">#MongoDB</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>小白必须懂的MongoDB的十大总结</div>
      <div>https://github.13sai.com/2021/02/03/307/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>13sai</div>
        </div>
      
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/02/06/syncOnce/" title="sync.Once">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">sync.Once</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/01/26/305/" title="vue子组件">
                        <span class="hidden-mobile">vue子组件</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  



  <script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});
  });
</script>




  <!-- Custom -->
  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="/images/qiniu/zan.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block" style="width:300px; height:300px;">
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span>2022</span> <i class="iconfont icon-copyright"></i> <a href="https://hexo.io/" target="_blank"><span>Powered by Hexo</span></a> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Theme is Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      皖ICP备14021992号
    </a>
  </span>
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?21791f27481aa4e0d1d544dde68bdb36";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  

  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
